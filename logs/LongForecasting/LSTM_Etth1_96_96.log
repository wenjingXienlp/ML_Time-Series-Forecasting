False
Args in experiment:
Namespace(is_training=1, train_only=False, model_id='ETTh1_96_96', model='LSTM', data='ETTh1', root_path='/opt/data/private/wtc_beifen/time_prediction/Autoformer/dataset/ETT-small', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='/opt/data/private/xwj/ML/LTSF-Linear-main/LSTM_cpkts', seq_len=96, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=10, train_epochs=10, batch_size=64, patience=3, learning_rate=0.005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=2, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use CPU
start training : ETTh1_96_96_LSTM_iter0
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3639719
	speed: 0.3504s/iter; left time: 427.7881s
Epoch: 1 cost time: 45.063732624053955
Epoch: 1, Steps: 132 | Train Loss: 0.4545513 Vali Loss: 0.9656653 Test Loss: 0.7645889
Validation loss decreased (inf --> 0.965665).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3077350
	speed: 1.6558s/iter; left time: 1803.1974s
Epoch: 2 cost time: 160.00182247161865
Epoch: 2, Steps: 132 | Train Loss: 0.3515295 Vali Loss: 0.9350554 Test Loss: 0.8260900
Validation loss decreased (0.965665 --> 0.935055).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2818644
	speed: 1.3275s/iter; left time: 1270.3764s
Epoch: 3 cost time: 79.66300559043884
Epoch: 3, Steps: 132 | Train Loss: 0.2874823 Vali Loss: 0.9308197 Test Loss: 0.8256922
Validation loss decreased (0.935055 --> 0.930820).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2528637
	speed: 7.1488s/iter; left time: 5897.7267s
Epoch: 4 cost time: 807.6888952255249
Epoch: 4, Steps: 132 | Train Loss: 0.2580147 Vali Loss: 0.9474108 Test Loss: 0.8591239
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2263928
	speed: 9.8519s/iter; left time: 6827.3951s
Epoch: 5 cost time: 867.4816071987152
Epoch: 5, Steps: 132 | Train Loss: 0.2379917 Vali Loss: 0.9963519 Test Loss: 0.9230816
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 0.2225332
	speed: 9.9622s/iter; left time: 5588.8166s
Epoch: 6 cost time: 881.0951766967773
Epoch: 6, Steps: 132 | Train Loss: 0.2258880 Vali Loss: 1.0126885 Test Loss: 0.9039593
EarlyStopping counter: 3 out of 3
Early stopping
testing : ETTh1_96_96_LSTM_iter0
test 2785
mse:0.8269448280334473, mae:0.705530047416687
Use CPU
start training : ETTh1_96_96_LSTM_iter1
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3925218
	speed: 6.6414s/iter; left time: 8109.2065s
Epoch: 1 cost time: 883.4296989440918
Epoch: 1, Steps: 132 | Train Loss: 0.4521943 Vali Loss: 0.9526565 Test Loss: 0.7521614
Validation loss decreased (inf --> 0.952657).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3522489
	speed: 9.8037s/iter; left time: 10676.2258s
Epoch: 2 cost time: 882.2817656993866
Epoch: 2, Steps: 132 | Train Loss: 0.3278781 Vali Loss: 0.8655358 Test Loss: 0.7518931
Validation loss decreased (0.952657 --> 0.865536).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2789988
	speed: 9.9865s/iter; left time: 9557.0994s
Epoch: 3 cost time: 883.0886523723602
Epoch: 3, Steps: 132 | Train Loss: 0.2720937 Vali Loss: 0.9044042 Test Loss: 0.8716003
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2530909
	speed: 9.9748s/iter; left time: 8229.1760s
Epoch: 4 cost time: 880.7301352024078
Epoch: 4, Steps: 132 | Train Loss: 0.2674215 Vali Loss: 0.9069243 Test Loss: 0.8465469
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2277149
	speed: 10.0656s/iter; left time: 6975.4605s
Epoch: 5 cost time: 891.3361258506775
Epoch: 5, Steps: 132 | Train Loss: 0.2348772 Vali Loss: 0.9583967 Test Loss: 0.9867716
EarlyStopping counter: 3 out of 3
Early stopping
testing : ETTh1_96_96_LSTM_iter1
test 2785
mse:0.7531980872154236, mae:0.6791839003562927
Use CPU
start training : ETTh1_96_96_LSTM_iter2
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3590112
	speed: 6.6393s/iter; left time: 8106.6450s
Epoch: 1 cost time: 881.7202303409576
Epoch: 1, Steps: 132 | Train Loss: 0.4647169 Vali Loss: 0.8670713 Test Loss: 0.7654077
Validation loss decreased (inf --> 0.867071).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3071847
	speed: 9.9954s/iter; left time: 10885.0045s
Epoch: 2 cost time: 880.9433174133301
Epoch: 2, Steps: 132 | Train Loss: 0.3232086 Vali Loss: 0.8670892 Test Loss: 0.7535258
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2760831
	speed: 10.1544s/iter; left time: 9717.7611s
Epoch: 3 cost time: 918.1139481067657
Epoch: 3, Steps: 132 | Train Loss: 0.2808158 Vali Loss: 0.9550191 Test Loss: 0.7682151
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2294495
	speed: 10.3606s/iter; left time: 8547.4608s
Epoch: 4 cost time: 904.5862753391266
Epoch: 4, Steps: 132 | Train Loss: 0.2474550 Vali Loss: 1.0439011 Test Loss: 0.8775707
EarlyStopping counter: 3 out of 3
Early stopping
testing : ETTh1_96_96_LSTM_iter2
test 2785
mse:0.7655752301216125, mae:0.6772142052650452
Use CPU
start training : ETTh1_96_96_LSTM_iter3
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3805942
	speed: 9.0687s/iter; left time: 11072.8948s
Epoch: 1 cost time: 1131.0777349472046
Epoch: 1, Steps: 132 | Train Loss: 0.4591824 Vali Loss: 0.9693979 Test Loss: 0.7878914
Validation loss decreased (inf --> 0.969398).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3165669
	speed: 10.2260s/iter; left time: 11136.1576s
Epoch: 2 cost time: 914.9377295970917
Epoch: 2, Steps: 132 | Train Loss: 0.3201748 Vali Loss: 0.9167573 Test Loss: 0.8727083
Validation loss decreased (0.969398 --> 0.916757).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2671015
	speed: 13.6950s/iter; left time: 13106.1139s
Epoch: 3 cost time: 1382.3717589378357
Epoch: 3, Steps: 132 | Train Loss: 0.2696345 Vali Loss: 1.0330908 Test Loss: 0.8654718
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2097705
	speed: 14.0524s/iter; left time: 11593.2629s
Epoch: 4 cost time: 1064.2210223674774
Epoch: 4, Steps: 132 | Train Loss: 0.2440031 Vali Loss: 1.1222966 Test Loss: 0.9100195
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2419672
	speed: 11.3682s/iter; left time: 7878.1955s
Epoch: 5 cost time: 1138.6199972629547
Epoch: 5, Steps: 132 | Train Loss: 0.2314801 Vali Loss: 1.1243656 Test Loss: 0.9021069
EarlyStopping counter: 3 out of 3
Early stopping
testing : ETTh1_96_96_LSTM_iter3
test 2785
mse:0.8724343776702881, mae:0.7409980297088623
Use CPU
start training : ETTh1_96_96_LSTM_iter4
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4086164
	speed: 9.2369s/iter; left time: 11278.2893s
Epoch: 1 cost time: 1234.1074213981628
Epoch: 1, Steps: 132 | Train Loss: 0.4528124 Vali Loss: 0.9490156 Test Loss: 0.7274407
Validation loss decreased (inf --> 0.949016).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3113529
	speed: 14.0616s/iter; left time: 15313.1366s
Epoch: 2 cost time: 1234.8456225395203
Epoch: 2, Steps: 132 | Train Loss: 0.3282805 Vali Loss: 0.9217286 Test Loss: 0.7649780
Validation loss decreased (0.949016 --> 0.921729).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2532620
	speed: 13.7213s/iter; left time: 13131.2628s
Epoch: 3 cost time: 1213.2770709991455
Epoch: 3, Steps: 132 | Train Loss: 0.2767777 Vali Loss: 0.9684479 Test Loss: 0.8716545
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2467844
	speed: 13.8532s/iter; left time: 11428.9223s
Epoch: 4 cost time: 1230.6354129314423
Epoch: 4, Steps: 132 | Train Loss: 0.2448101 Vali Loss: 1.0125510 Test Loss: 0.9622869
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2795538
	speed: 13.6880s/iter; left time: 9485.8119s
Epoch: 5 cost time: 1215.1468665599823
Epoch: 5, Steps: 132 | Train Loss: 0.2360250 Vali Loss: 1.0283455 Test Loss: 0.9168079
EarlyStopping counter: 3 out of 3
Early stopping
testing : ETTh1_96_96_LSTM_iter4
test 2785
mse:0.765861988067627, mae:0.6875813603401184
Use CPU
start training : ETTh1_96_96_LSTM_iter5
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3943187
	speed: 8.6653s/iter; left time: 10580.2849s
Epoch: 1 cost time: 1171.6039552688599
Epoch: 1, Steps: 132 | Train Loss: 0.4818083 Vali Loss: 0.9484699 Test Loss: 0.7852044
Validation loss decreased (inf --> 0.948470).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.2977066
	speed: 14.0097s/iter; left time: 15256.5944s
Epoch: 2 cost time: 1242.329575061798
Epoch: 2, Steps: 132 | Train Loss: 0.3285078 Vali Loss: 0.8856637 Test Loss: 0.7600117
Validation loss decreased (0.948470 --> 0.885664).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2522586
	speed: 13.8679s/iter; left time: 13271.5864s
Epoch: 3 cost time: 1228.2871870994568
Epoch: 3, Steps: 132 | Train Loss: 0.2794889 Vali Loss: 0.9336710 Test Loss: 0.7781202
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2484687
	speed: 14.0811s/iter; left time: 11616.9456s
Epoch: 4 cost time: 1249.644240617752
Epoch: 4, Steps: 132 | Train Loss: 0.2471725 Vali Loss: 0.9213060 Test Loss: 0.8690913
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2256940
	speed: 13.8857s/iter; left time: 9622.8178s
Epoch: 5 cost time: 1230.8756742477417
Epoch: 5, Steps: 132 | Train Loss: 0.2246258 Vali Loss: 0.9447529 Test Loss: 0.8818653
EarlyStopping counter: 3 out of 3
Early stopping
testing : ETTh1_96_96_LSTM_iter5
test 2785
mse:0.7612614631652832, mae:0.6859537959098816
Use CPU
start training : ETTh1_96_96_LSTM_iter6
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3835084
	speed: 9.0803s/iter; left time: 11087.0516s
Epoch: 1 cost time: 1209.152408361435
Epoch: 1, Steps: 132 | Train Loss: 0.4390419 Vali Loss: 0.9792106 Test Loss: 0.6554667
Validation loss decreased (inf --> 0.979211).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.2950732
	speed: 13.6252s/iter; left time: 14837.8286s
Epoch: 2 cost time: 1202.512818813324
Epoch: 2, Steps: 132 | Train Loss: 0.3179218 Vali Loss: 0.9423262 Test Loss: 0.7637125
Validation loss decreased (0.979211 --> 0.942326).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2499192
	speed: 13.3943s/iter; left time: 12818.3431s
Epoch: 3 cost time: 1188.986577987671
Epoch: 3, Steps: 132 | Train Loss: 0.2730271 Vali Loss: 0.9612825 Test Loss: 0.8777714
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2355990
	speed: 13.6999s/iter; left time: 11302.3838s
Epoch: 4 cost time: 1215.7170219421387
Epoch: 4, Steps: 132 | Train Loss: 0.2376759 Vali Loss: 0.9878149 Test Loss: 0.8574350
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2061934
	speed: 13.7822s/iter; left time: 9551.0612s
Epoch: 5 cost time: 1238.3278079032898
Epoch: 5, Steps: 132 | Train Loss: 0.2113547 Vali Loss: 0.9996058 Test Loss: 0.9168932
EarlyStopping counter: 3 out of 3
Early stopping
testing : ETTh1_96_96_LSTM_iter6
test 2785
mse:0.765852153301239, mae:0.6776420474052429
Use CPU
start training : ETTh1_96_96_LSTM_iter7
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3334663
	speed: 9.5276s/iter; left time: 11633.1665s
Epoch: 1 cost time: 1242.827611207962
Epoch: 1, Steps: 132 | Train Loss: 0.4545109 Vali Loss: 1.0550151 Test Loss: 0.9011707
Validation loss decreased (inf --> 1.055015).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3076855
	speed: 13.2743s/iter; left time: 14455.6642s
Epoch: 2 cost time: 1179.6152966022491
Epoch: 2, Steps: 132 | Train Loss: 0.3254874 Vali Loss: 0.9867187 Test Loss: 0.7725429
Validation loss decreased (1.055015 --> 0.986719).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2757824
	speed: 13.2001s/iter; left time: 12632.4686s
Epoch: 3 cost time: 1165.9250259399414
Epoch: 3, Steps: 132 | Train Loss: 0.2791630 Vali Loss: 0.9991711 Test Loss: 0.7154953
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2284529
	speed: 13.5804s/iter; left time: 11203.8195s
Epoch: 4 cost time: 1563.1674830913544
Epoch: 4, Steps: 132 | Train Loss: 0.2434137 Vali Loss: 1.0097072 Test Loss: 0.7785314
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2231862
	speed: 28.8197s/iter; left time: 19972.0573s
Epoch: 5 cost time: 2545.366336107254
Epoch: 5, Steps: 132 | Train Loss: 0.2216925 Vali Loss: 1.0364212 Test Loss: 0.8407503
EarlyStopping counter: 3 out of 3
Early stopping
testing : ETTh1_96_96_LSTM_iter7
test 2785
mse:0.773646354675293, mae:0.6907508373260498
Use CPU
start training : ETTh1_96_96_LSTM_iter8
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3999483
	speed: 19.2192s/iter; left time: 23466.6378s
Epoch: 1 cost time: 2550.190113067627
Epoch: 1, Steps: 132 | Train Loss: 0.4812900 Vali Loss: 0.9342995 Test Loss: 0.7513986
Validation loss decreased (inf --> 0.934300).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.2678031
	speed: 28.6535s/iter; left time: 31203.6331s
Epoch: 2 cost time: 2535.96760225296
Epoch: 2, Steps: 132 | Train Loss: 0.3276331 Vali Loss: 0.9014603 Test Loss: 0.7330530
Validation loss decreased (0.934300 --> 0.901460).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2918020
	speed: 28.6759s/iter; left time: 27442.8456s
Epoch: 3 cost time: 2541.98241853714
Epoch: 3, Steps: 132 | Train Loss: 0.2802369 Vali Loss: 0.9497371 Test Loss: 0.8787985
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2348139
	speed: 28.8176s/iter; left time: 23774.5595s
Epoch: 4 cost time: 2564.168393611908
Epoch: 4, Steps: 132 | Train Loss: 0.2500786 Vali Loss: 0.9495208 Test Loss: 0.8048137
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2188345
	speed: 28.8450s/iter; left time: 19989.6074s
Epoch: 5 cost time: 2550.5541841983795
Epoch: 5, Steps: 132 | Train Loss: 0.2245934 Vali Loss: 0.9787002 Test Loss: 0.8243691
EarlyStopping counter: 3 out of 3
Early stopping
testing : ETTh1_96_96_LSTM_iter8
test 2785
mse:0.7341799736022949, mae:0.6688937544822693
Use CPU
start training : ETTh1_96_96_LSTM_iter9
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.3589686
	speed: 19.3799s/iter; left time: 23662.8787s
Epoch: 1 cost time: 2577.3250300884247
Epoch: 1, Steps: 132 | Train Loss: 0.4601139 Vali Loss: 0.9439614 Test Loss: 0.7428406
Validation loss decreased (inf --> 0.943961).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 0.3343171
	speed: 30.0781s/iter; left time: 32755.0462s
Epoch: 2 cost time: 2813.6349408626556
Epoch: 2, Steps: 132 | Train Loss: 0.3223869 Vali Loss: 0.8944938 Test Loss: 0.8512453
Validation loss decreased (0.943961 --> 0.894494).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 0.2624181
	speed: 31.8812s/iter; left time: 30510.2901s
Epoch: 3 cost time: 2762.963806629181
Epoch: 3, Steps: 132 | Train Loss: 0.2723545 Vali Loss: 0.9401964 Test Loss: 0.8838291
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 0.2281448
	speed: 32.6108s/iter; left time: 26903.8931s
Epoch: 4 cost time: 2765.4470784664154
Epoch: 4, Steps: 132 | Train Loss: 0.2410114 Vali Loss: 0.9976997 Test Loss: 0.9431343
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 0.2113440
	speed: 31.0588s/iter; left time: 21523.7619s
Epoch: 5 cost time: 2933.16316819191
Epoch: 5, Steps: 132 | Train Loss: 0.2174943 Vali Loss: 1.0234652 Test Loss: 0.9015297
EarlyStopping counter: 3 out of 3
Early stopping
testing : ETTh1_96_96_LSTM_iter9
test 2785
mse:0.8508675694465637, mae:0.7293233871459961
